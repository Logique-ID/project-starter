<!-- Generated by SpecStory, Markdown v2.1.0 -->

<!-- cursor Session 7615cd37-aef9-44f2-bbc4-cd5dcf00be3d (2026-01-13 04:38Z) -->

# Conditional use_dio for brick template (2026-01-13 04:38Z)

_**User (2026-01-13 01:10Z)**_

@src/brick.yaml @src/__brick__ implement conditional use_dio for brick template

---

_**Agent (model default, mode Plan)**_



---


Reviewing how conditionals are implemented in the brick template and identifying all Dio-related code.


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/brick.yaml</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="search" data-tool-name="codebase_search">
<details>
                <summary>Tool use: **codebase_search** • Searched codebase "How is use_firebase conditional variable used in the brick template files?" • **15** results</summary>
            
| File | Lines |
|------|-------|
| `src/__brick__/{{project_name}}/lib/initializer.dart` | L36 |
| `src/__brick__/{{project_name}}/lib/main_stg.dart` | L10 |
| `src/__brick__/{{project_name}}/lib/main_dev.dart` | L10 |
| `src/__brick__/{{project_name}}/{{#use_firebase}}flutterfire-config.sh{{/use_firebase}}` | L51 |
| `src/__brick__/{{project_name}}/lib/src/service/{{#use_firebase}}firebase{{/use_firebase}}/firebase_service.dart` | L64-95 |
| `src/__brick__/{{project_name}}/pubspec.yaml` | L83 |
| `src/__brick__/{{project_name}}/lib/main_prod.dart` | L10 |
| `src/__brick__/{{project_name}}/README.md` | L67 |
| `src/__brick__/{{project_name}}/lib/src/service/{{#use_firebase}}firebase{{/use_firebase}}/firebase_service.dart` | L68 |
| `src/__brick__/{{project_name}}/android/settings.gradle.kts` | L30 |
| `src/__brick__/{{project_name}}/lib/src/routing/app_startup.dart` | L66 |
| `src/__brick__/{{project_name}}/lib/src/service/notification/local_notification.dart` | L36 |
| `src/__brick__/{{project_name}}/lib/src/service/{{#use_firebase}}firebase{{/use_firebase}}/firebase_service.g.dart` | L52 |
| `src/__brick__/{{project_name}}/lib/src/service/notification/local_notification.dart` | L78-135 |
| `src/__brick__/{{project_name}}/ios/Runner.xcodeproj/project.pbxproj` | L249-280 |

</details>
</tool-use>

---

<tool-use data-tool-type="search" data-tool-name="codebase_search">
<details>
                <summary>Tool use: **codebase_search** • Searched codebase "How is use_localization conditional variable used in the brick template files?" • **15** results</summary>
            
| File | Lines |
|------|-------|
| `src/__brick__/{{project_name}}/lib/src/feature/home/presentation/home_subscreen.dart` | L39 |
| `src/__brick__/{{project_name}}/lib/src/core/mixins/{{#use_localization}}localization_mixin.dart{{/use_localization}}` | L69 |
| `src/__brick__/{{project_name}}/{{#use_localization}}l10n.yaml{{/use_localization}}` | L5 |
| `src/__brick__/{{project_name}}/lib/src/{{#use_localization}}localization{{/use_localization}}/app_localizations_context.dart` | L7 |
| `src/__brick__/{{project_name}}/lib/src/core/mixins/{{#use_localization}}localization_mixin.dart{{/use_localization}}` | L65-77 |
| `src/__brick__/{{project_name}}/lib/src/{{#use_localization}}localization{{/use_localization}}/app_localizations_provider.dart` | L36 |
| `src/__brick__/{{project_name}}/lib/src/{{#use_localization}}localization{{/use_localization}}/string_hardcoded.dart` | L5 |
| `src/__brick__/{{project_name}}/lib/src/{{^use_localization}}localization{{/use_localization}}/string_hardcoded.dart` | L5 |
| `src/__brick__/{{project_name}}/lib/src/{{#use_localization}}localization{{/use_localization}}/app_en.arb` | L4 |
| `src/__brick__/{{project_name}}/lib/src/{{#use_localization}}localization{{/use_localization}}/app_id.arb` | L4 |
| `src/__brick__/{{project_name}}/lib/src/{{#use_localization}}localization{{/use_localization}}/app_localization_repository.dart` | L54-60 |
| `src/__brick__/{{project_name}}/lib/src/feature/login/presentation/login_screen.dart` | L23-53 |
| `src/__brick__/{{project_name}}/lib/src/{{#use_localization}}localization{{/use_localization}}/app_localizations.dart` | L58-118 |
| `src/__brick__/{{project_name}}/lib/src/{{#use_localization}}localization{{/use_localization}}/app_localizations_en.dart` | L16 |
| `src/__brick__/{{project_name}}/lib/src/{{#use_localization}}localization{{/use_localization}}/app_localization_repository.dart` | L58 |

</details>
</tool-use>

---

<tool-use data-tool-type="search" data-tool-name="grep">
<details>
<summary>Tool use: **grep** • Grep for "dio|Dio|DIO" in "src/__brick__" • 127 matches</summary>

Output mode: content


| File | Content | Line |
|------|------|------|
| `src/__brick__/\{{project_name\}}/pubspec.yaml` | `dio: 5.9.0` | L50 |
| `src/__brick__/\{{project_name\}}/pubspec.yaml` | `alice_dio: ^1.0.7` | L51 |
| `src/__brick__/\{{project_name\}}/lib/src/feature/login/data/login_repository.dart` | `import 'package:dio/dio.dart';` | L1 |
| `src/__brick__/\{{project_name\}}/lib/src/feature/login/data/login_repository.dart` | `import '../../../utils/data_source_config/dio/dio_config.dart';` | L5 |
| `src/__brick__/\{{project_name\}}/lib/src/feature/login/data/login_repository.dart` | `final dio = ref.watch(dioConfigProvider);` | L19 |
| `src/__brick__/\{{project_name\}}/lib/src/feature/login/data/login_repository.dart` | `final response = await dio.post(` | L20 |
| `src/__brick__/\{{project_name\}}/lib/src/feature/login/data/login_repository.dart` | `\} on DioException catch (error) \{` | L48 |
| `src/__brick__/\{{project_name\}}/lib/src/feature/login/data/login_repository.dart` | `return onDioError(error);` | L49 |
| `src/__brick__/\{{project_name\}}/android/app/build.gradle.kts` | `// TODO: Specify your own unique Application ID (https://developer.android.com/studio/build/application-id.html).` | L30 |
| `src/__brick__/\{{project_name\}}/pubspec.lock` | `alice_dio:` | L28 |
| `src/__brick__/\{{project_name\}}/pubspec.lock` | `name: alice_dio` | L31 |
| `src/__brick__/\{{project_name\}}/pubspec.lock` | `dio:` | L324 |
| `src/__brick__/\{{project_name\}}/pubspec.lock` | `name: dio` | L327 |
| `src/__brick__/\{{project_name\}}/pubspec.lock` | `dio_web_adapter:` | L332 |
| `src/__brick__/\{{project_name\}}/pubspec.lock` | `name: dio_web_adapter` | L335 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/LaunchBackground.imageset/Contents.json` | `"idiom" : "universal",` | L5 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/LaunchBackground.imageset/Contents.json` | `"idiom" : "universal",` | L9 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/LaunchBackground.imageset/Contents.json` | `"idiom" : "universal",` | L13 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/LaunchImage.imageset/Contents.json` | `"idiom" : "universal",` | L5 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/LaunchImage.imageset/Contents.json` | `"idiom" : "universal",` | L10 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/LaunchImage.imageset/Contents.json` | `"idiom" : "universal",` | L15 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/AppIcon.appiconset/Contents.json` | `\{"images":[\{"size":"20x20","idiom":"universal","filename":"Icon-App-20x20@2x.png","scale":"2x","platform":"ios"\},\{"size":"20x20","idiom":"universal","filename":"Icon-App-20x20@3x.png","scale":"3x","platform":"ios"\},\{"size":"29x29","idiom":"universal","filename":"Icon-App-29x29@2x.png","scale":"2x","platform":"ios"\},\{"size":"29x29","idiom":"universal","filename":"Icon-App-29x29@3x.png","scale":"3x","platform":"ios"\},\{"size":"38x38","idiom":"universal","filename":"Icon-App-38x38@2x.png","scale":"2x","platform":"ios"\},\{"size":"38x38","idiom":"universal","filename":"Icon-App-38x38@3x.png","scale":"3x","platform":"ios"\},\{"size":"40x40","idiom":"universal","filename":"Icon-App-40x40@2x.png","scale":"2x","platform":"ios"\},\{"size":"40x40","idiom":"universal","filename":"Icon-App-40x40@3x.png","scale":"3x","platform":"ios"\},\{"size":"60x60","idiom":"universal","filename":"Icon-App-60x60@2x.png","scale":"2x","platform":"ios"\},\{"size":"60x60","idiom":"universal","filename":"Icon-App-60x60@3x.png", [... omitted end of long line]` | L1 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `import 'package:alice_dio/alice_dio_adapter.dart';` | L5 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `import 'package:dio/dio.dart';` | L6 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `part 'dio_config.g.dart';` | L18 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `final _dioBaseOptions = BaseOptions(` | L20 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `Dio dioConfig(Ref ref) \{` | L37 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `final dio = Dio(_dioBaseOptions);` | L38 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `final aliceDioAdapter = AliceDioAdapter();` | L42 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `alice.addAdapter(aliceDioAdapter);` | L44 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `dio.interceptors.add(aliceDioAdapter);` | L46 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `dio.interceptors.add(` | L47 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `dio.interceptors.add(` | L56 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `DioException(` | L84 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `type: DioExceptionType.badResponse,` | L87 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `return dio;` | L111 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `final dioRefreshToken = Dio(_dioBaseOptions);` | L119 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `dioRefreshToken.interceptors.add(` | L120 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `final response = await dioRefreshToken.get(` | L128 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `onDioError(DioException error) \{` | L169 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `if (error.type == DioExceptionType.badResponse) \{` | L170 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `\} else if (error.type == DioExceptionType.cancel) \{` | L176 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `\} else if (error.type == DioExceptionType.badCertificate) \{` | L178 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `\} else if (error.type == DioExceptionType.connectionError) \{` | L180 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `\} else if (error.type == DioExceptionType.connectionTimeout) \{` | L182 |
| `src/__brick__/\{{project_name\}}/lib/src/routing/app_router.dart` | `import '../utils/data_source_config/dio/dio_config.dart';` | L12 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.g.dart` | `part of 'dio_config.dart';` | L3 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.g.dart` | `@ProviderFor(dioConfig)` | L12 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.g.dart` | `const dioConfigProvider = DioConfigProvider._();` | L13 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.g.dart` | `final class DioConfigProvider extends $FunctionalProvider<Dio, Dio, Dio>` | L15 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.g.dart` | `with $Provider<Dio> \{` | L16 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.g.dart` | `const DioConfigProvider._()` | L17 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.g.dart` | `name: r'dioConfigProvider',` | L22 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.g.dart` | `String debugGetCreateSourceHash() => _$dioConfigHash();` | L29 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.g.dart` | `$ProviderElement<Dio> $createElement($ProviderPointer pointer) =>` | L33 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.g.dart` | `Dio create(Ref ref) \{` | L37 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.g.dart` | `return dioConfig(ref);` | L38 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.g.dart` | `Override overrideWithValue(Dio value) \{` | L42 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.g.dart` | `providerOverride: $SyncValueProvider<Dio>(value),` | L45 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.g.dart` | `String _$dioConfigHash() => r'7ee90bc74c09de0e6b2503d8218ec7d975d6c111';` | L50 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/cancel_token_ref.dart` | `import 'package:dio/dio.dart';` | L1 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/stgLaunchImage.imageset/Contents.json` | `"idiom" : "universal",` | L4 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/stgLaunchImage.imageset/Contents.json` | `"idiom" : "universal",` | L9 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/stgLaunchImage.imageset/Contents.json` | `"idiom" : "universal",` | L14 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/stgAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L5 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/stgAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L11 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/stgAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L17 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/stgAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L23 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/stgAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L29 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/stgAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L35 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/stgAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L41 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/stgAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L47 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/stgAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L53 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/stgAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L59 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/stgAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L65 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/stgAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L71 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/stgAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L77 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/stgAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L83 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/stgAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L89 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/stgAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L95 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/stgAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L101 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/stgAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L107 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/stgAppIcon.appiconset/Contents.json` | `"idiom" : "ios-marketing",` | L113 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/prodLaunchImage.imageset/Contents.json` | `"idiom" : "universal",` | L4 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/prodLaunchImage.imageset/Contents.json` | `"idiom" : "universal",` | L9 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/prodLaunchImage.imageset/Contents.json` | `"idiom" : "universal",` | L14 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/prodAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L5 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/prodAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L11 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/prodAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L17 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/prodAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L23 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/prodAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L29 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/prodAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L35 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/prodAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L41 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/prodAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L47 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/prodAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L53 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/prodAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L59 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/prodAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L65 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/prodAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L71 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/prodAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L77 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/prodAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L83 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/prodAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L89 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/prodAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L95 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/prodAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L101 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/prodAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L107 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/prodAppIcon.appiconset/Contents.json` | `"idiom" : "ios-marketing",` | L113 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/devLaunchImage.imageset/Contents.json` | `"idiom" : "universal",` | L4 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/devLaunchImage.imageset/Contents.json` | `"idiom" : "universal",` | L9 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/devLaunchImage.imageset/Contents.json` | `"idiom" : "universal",` | L14 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/devAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L5 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/devAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L11 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/devAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L17 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/devAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L23 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/devAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L29 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/devAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L35 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/devAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L41 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/devAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L47 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/devAppIcon.appiconset/Contents.json` | `"idiom" : "iphone",` | L53 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/devAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L59 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/devAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L65 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/devAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L71 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/devAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L77 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/devAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L83 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/devAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L89 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/devAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L95 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/devAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L101 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/devAppIcon.appiconset/Contents.json` | `"idiom" : "ipad",` | L107 |
| `src/__brick__/\{{project_name\}}/ios/Runner/Assets.xcassets/devAppIcon.appiconset/Contents.json` | `"idiom" : "ios-marketing",` | L113 |


</details>
</tool-use>

---



---


Reviewing key files to understand the full scope:


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/pubspec.yaml</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/utils/data_source_config/dio/dio_config.dart</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/feature/login/data/login_repository.dart</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/routing/app_router.dart</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/utils/data_source_config/dio/cancel_token_ref.dart</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="generic" data-tool-name="list_dir">
<details>
            <summary>Tool use: **list_dir** • Listed directory, 0 results</summary>
        
No results found
</details>
</tool-use>

---



---


Checking for other files that reference Dio or Alice:


---

<tool-use data-tool-type="search" data-tool-name="grep">
<details>
<summary>Tool use: **grep** • Grep for "alice|Alice" in "src/__brick__" • 18 matches</summary>

Output mode: content


| File | Content | Line |
|------|------|------|
| `src/__brick__/\{{project_name\}}/pubspec.yaml` | `alice_dio: ^1.0.7` | L51 |
| `src/__brick__/\{{project_name\}}/pubspec.yaml` | `alice: ^1.0.0` | L52 |
| `src/__brick__/\{{project_name\}}/lib/src/common_widget/connection_listener_widget.dart` | `ref.read(aliceProvider).showInspector();` | L97 |
| `src/__brick__/\{{project_name\}}/pubspec.lock` | `alice:` | L20 |
| `src/__brick__/\{{project_name\}}/pubspec.lock` | `name: alice` | L23 |
| `src/__brick__/\{{project_name\}}/pubspec.lock` | `alice_dio:` | L28 |
| `src/__brick__/\{{project_name\}}/pubspec.lock` | `name: alice_dio` | L31 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `import 'package:alice/alice.dart';` | L3 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `import 'package:alice/model/alice_configuration.dart';` | L4 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `import 'package:alice_dio/alice_dio_adapter.dart';` | L5 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `final aliceProvider = Provider<Alice>((ref) \{` | L27 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `return Alice(` | L28 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `configuration: AliceConfiguration(` | L29 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `final alice = ref.watch(aliceProvider);` | L41 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `final aliceDioAdapter = AliceDioAdapter();` | L42 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `alice.addAdapter(aliceDioAdapter);` | L44 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `dio.interceptors.add(aliceDioAdapter);` | L46 |
| `src/__brick__/\{{project_name\}}/lib/src/routing/app_router.dart` | `navigatorKey: ref.watch(aliceProvider).getNavigatorKey(),` | L25 |


</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/routing/app_router.dart</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="search" data-tool-name="codebase_search">
<details>
                <summary>Tool use: **codebase_search** • Searched codebase "Where is aliceProvider used in the codebase?" • **15** results</summary>
            
| File | Lines |
|------|-------|
| `src/__brick__/{{project_name}}/lib/src/utils/data_source_config/dio/dio_config.dart` | L37 |
| `src/__brick__/{{project_name}}/lib/src/utils/data_source_config/dio/dio_config.dart` | L32-94 |
| `src/__brick__/{{project_name}}/pubspec.yaml` | L83 |
| `src/__brick__/{{project_name}}/.cursor/rules/riverpod-patterns.mdc` | L47 |
| `src/__brick__/{{project_name}}/lib/src/routing/app_router.dart` | L38 |
| `src/__brick__/{{project_name}}/lib/src/routing/app_startup.dart` | L66 |
| `src/__brick__/{{project_name}}/lib/src/{{#use_localization}}localization{{/use_localization}}/app_localization_repository.dart` | L58 |
| `src/__brick__/{{project_name}}/.cursor/rules/flutter-ui-patterns.mdc` | L1043-1088 |
| `src/__brick__/{{project_name}}/lib/src/{{#use_localization}}localization{{/use_localization}}/app_localizations_provider.dart` | L36 |
| `src/__brick__/{{project_name}}/lib/initializer.dart` | L36 |
| `src/__brick__/{{project_name}}/.cursor/rules/riverpod-patterns.mdc` | L45-102 |
| `src/__brick__/{{project_name}}/.cursor/rules/flutter-ui-patterns.mdc` | L1326-1380 |
| `src/__brick__/{{project_name}}/lib/src/feature/login/data/login_repository.g.dart` | L77 |
| `src/__brick__/{{project_name}}/lib/src/common_widget/connection_listener_widget.dart` | L72-124 |
| `src/__brick__/{{project_name}}/lib/src/routing/app_startup.g.dart` | L43 |

</details>
</tool-use>

---



---


Checking the connection listener widget:


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/common_widget/connection_listener_widget.dart</summary>

</details>
</tool-use>

---



---


Checking for other files that might use Dio or the dioConfigProvider:


---

<tool-use data-tool-type="search" data-tool-name="grep">
<details>
<summary>Tool use: **grep** • Grep for "dioConfigProvider|dioConfig|onDioError" in "src/__brick__" • 10 matches</summary>

Output mode: content


| File | Content | Line |
|------|------|------|
| `src/__brick__/\{{project_name\}}/lib/src/feature/login/data/login_repository.dart` | `final dio = ref.watch(dioConfigProvider);` | L19 |
| `src/__brick__/\{{project_name\}}/lib/src/feature/login/data/login_repository.dart` | `return onDioError(error);` | L49 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `Dio dioConfig(Ref ref) \{` | L37 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.dart` | `onDioError(DioException error) \{` | L169 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.g.dart` | `@ProviderFor(dioConfig)` | L12 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.g.dart` | `const dioConfigProvider = DioConfigProvider._();` | L13 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.g.dart` | `name: r'dioConfigProvider',` | L22 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.g.dart` | `String debugGetCreateSourceHash() => _$dioConfigHash();` | L29 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.g.dart` | `return dioConfig(ref);` | L38 |
| `src/__brick__/\{{project_name\}}/lib/src/utils/data_source_config/dio/dio_config.g.dart` | `String _$dioConfigHash() => r'7ee90bc74c09de0e6b2503d8218ec7d975d6c111';` | L50 |


</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/utils/data_source_config/dio/dio_config.g.dart</summary>

</details>
</tool-use>

---



---


Creating the implementation plan:


---

<tool-use data-tool-type="unknown" data-tool-name="create_plan">
<details>
<summary>Tool use: **create_plan**</summary>


Parameters:

```json
{
  "plan": "# Conditional use_dio Implementation\n\n## Overview\nImplement conditional &#96;use_dio&#96; support in the Mason brick template, allowing projects to opt-in or opt-out of Dio HTTP client and Alice debugging inspector. This follows the same conditional pattern used for &#96;use_firebase&#96; and &#96;use_localization&#96;.\n\n## Files to Modify\n\n### 1. &#96;src/__brick__/{{project_name}}/pubspec.yaml&#96;\n- Wrap Dio-related dependencies (lines 50-52) with &#96;{{#use_dio}}...{{/use_dio}}&#96;:\n  - &#96;dio: 5.9.0&#96;\n  - &#96;alice_dio: ^1.0.7&#96;\n  - &#96;alice: ^1.0.0&#96;\n\n### 2. &#96;src/__brick__/{{project_name}}/lib/src/utils/data_source_config/dio/&#96; (Directory)\n- Wrap entire &#96;dio/&#96; directory with conditional:\n  - &#96;{{#use_dio}}dio/{{/use_dio}}&#96; pattern for directory structure\n  - Files affected:\n    - &#96;dio_config.dart&#96;\n    - &#96;dio_config.g.dart&#96;\n    - &#96;cancel_token_ref.dart&#96;\n\n### 3. &#96;src/__brick__/{{project_name}}/lib/src/feature/login/data/login_repository.dart&#96;\n- Conditionally import Dio and dio_config\n- Conditionally use &#96;dioConfigProvider&#96; and &#96;onDioError&#96;\n- When &#96;use_dio&#96; is false, provide alternative implementation or stub (using &#96;http&#96; package or removing network calls)\n\n### 4. &#96;src/__brick__/{{project_name}}/lib/src/routing/app_router.dart&#96;\n- Conditionally import &#96;dio_config.dart&#96; (line 12)\n- Conditionally use &#96;aliceProvider.getNavigatorKey()&#96; (line 25)\n- When &#96;use_dio&#96; is false, use &#96;GlobalKey&lt;NavigatorState&gt;()&#96; as alternative\n\n### 5. &#96;src/__brick__/{{project_name}}/lib/src/common_widget/connection_listener_widget.dart&#96;\n- Already has commented-out &#96;aliceProvider&#96; usage (lines 95-98), no changes needed\n\n## Implementation Details\n\n### Conditional File Structure\nFollowing the &#96;use_firebase&#96; pattern where files are conditionally included:\n- &#96;{{#use_dio}}dio/dio_config.dart{{/use_dio}}&#96;\n- &#96;{{#use_dio}}dio/cancel_token_ref.dart{{/use_dio}}&#96;\n\n### Alternative Implementations When &#96;use_dio&#96; is False\n\n**For &#96;app_router.dart&#96;:**\n- Replace &#96;ref.watch(aliceProvider).getNavigatorKey()&#96; with &#96;GlobalKey&lt;NavigatorState&gt;()&#96;\n\n**For &#96;login_repository.dart&#96;:**\n- Option A: Use &#96;http&#96; package as alternative HTTP client\n- Option B: Stub out network calls (return mock data or throw \"Not implemented\")\n- Option C: Remove Dio-specific error handling\n\n**For &#96;pubspec.yaml&#96;:**\n- When &#96;use_dio&#96; is false, optionally add &#96;http&#96; package as alternative if we choose Option A for login_repository\n\n## Pattern Reference\nFollowing existing conditional patterns:\n- &#96;{{#use_firebase}}...{{/use_firebase}}&#96; for Firebase files and imports\n- &#96;{{#use_localization}}...{{/use_localization}}&#96; for localization files and imports\n- &#96;{{^use_localization}}...{{/use_localization}}&#96; for alternative implementations\n\n## Testing Considerations\n- Verify brick generation works with both &#96;use_dio: true&#96; and &#96;use_dio: false&#96;\n- Ensure no compilation errors when Dio is excluded\n- Verify router navigation works without Alice navigatorKey",
  "name": "Conditional use_dio Implementation",
  "overview": "Implement conditional &#96;use_dio&#96; variable in the Mason brick template, following the same pattern as &#96;use_firebase&#96; and &#96;use_localization&#96;. This will conditionally include/exclude Dio-related dependencies, files, and code based on the &#96;use_dio&#96; boolean variable."
}
```
Additional data:

```json
{
  "reviewData": {
    "status": "Requested",
    "selectedOption": "none",
    "isShowingInput": false
  },
  "planUri": "file:///Users/cirimin/.cursor/plans/conditional_use_dio_implementation_9bf5fab4.plan.md",
  "hasOpenedEditor": true,
  "pinnedName": "Conditional use_dio Implementation"
}
```
Result:

```json
{
  "accepted": {},
  "planUri": "/Users/cirimin/.cursor/plans/conditional_use_dio_implementation_9bf5fab4.plan.md"
}
```
Status: **completed**


</details>
</tool-use>

---

_**User (2026-01-13 01:10Z)**_

Implement the plan as specified, it is attached for your reference. Do NOT edit the plan file itself.

To-do's from the plan have already been created. Do not create them again. Mark them as in_progress as you work, starting with the first one. Don't stop until you have completed all the to-dos.

---

_**Agent (model default, mode Agent)**_



---

Implementing conditional `use_dio` support. Reviewing the current files, then applying the changes.


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/pubspec.yaml</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/feature/login/data/login_repository.dart</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/routing/app_router.dart</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/utils/data_source_config/dio/dio_config.dart</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/utils/data_source_config/dio/cancel_token_ref.dart</summary>

</details>
</tool-use>

---



---

Checking how conditional directories are structured by examining the Firebase pattern:


---

<tool-use data-tool-type="generic" data-tool-name="list_dir">
<details>
            <summary>Tool use: **list_dir** • Listed directory, 0 results</summary>
        
No results found
</details>
</tool-use>

---

<tool-use data-tool-type="generic" data-tool-name="glob_file_search">
<details>
<summary>Tool use: **glob_file_search** • Searched codebase "**/firebase/**" • **0** result in **1** directory</summary>

Directory: **/Users/cirimin/Logique/Project Starter/project-starter/src/__brick__** (0 file)

</details>
</tool-use>

---



---

Checking the exact directory structure pattern:


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/service/{{#use_firebase}}firebase{{/use_firebase}}/firebase_service.dart</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="generic" data-tool-name="list_dir">
<details>
            <summary>Tool use: **list_dir** • Listed directory, 0 results</summary>
        
No results found
</details>
</tool-use>

---



---

Implementing the changes. Starting with `pubspec.yaml`:


---

<tool-use data-tool-type="write" data-tool-name="search_replace">

<details><summary>Tool use: **search_replace** • Edit file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/pubspec.yaml</summary>

**Chunk 1**
Lines added: 3, lines removed: undefined

```diff
@@ -48,7 +48,10 @@
    go_router: 17.0.0
    lazy_load_indexed_stack: 1.2.1
+   {{#use_dio}}
+   # dio
    dio: 5.9.0
    alice_dio: ^1.0.7
    alice: ^1.0.0
+   {{/use_dio}}
    flutter_local_notifications: ^19.5.0
    flutter_svg: ^2.2.2
```

</details>

</tool-use>

---



---

Creating the conditional directory structure for Dio files. Creating files in the new conditional path:


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/utils/data_source_config/dio/dio_config.g.dart</summary>

</details>
</tool-use>

---



---

Creating files in the conditional directory structure:


---

<tool-use data-tool-type="write" data-tool-name="write">

<details><summary>Tool use: **write** • Edit file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/utils/data_source_config/{{#use_dio}}dio{{/use_dio}}/dio_config.dart</summary>

**Chunk 1**
Lines added: 188, lines removed: 1

```diff
@@ -1,1 +1,188 @@
- 
+ import 'dart:developer';
+ 
+ import 'package:alice/alice.dart';
+ import 'package:alice/model/alice_configuration.dart';
+ import 'package:alice_dio/alice_dio_adapter.dart';
+ import 'package:dio/dio.dart';
+ import 'package:flutter/foundation.dart';
+ import 'package:flutter_riverpod/flutter_riverpod.dart';
+ import 'package:riverpod_annotation/riverpod_annotation.dart';
+ 
+ import '../../../../flavor.dart';
+ import '../../../constant/constants.dart';
+ import '../../../constant/error_message.dart';
+ import '../../../feature/authentication/data/auth_repository.dart';
+ import '../../../feature/login/domain/login_response.dart';
+ import '../../common_utils.dart';
+ 
+ part 'dio_config.g.dart';
+ 
+ final _dioBaseOptions = BaseOptions(
+   baseUrl: F.apiUrl,
+   connectTimeout: const Duration(seconds: Constants.durationInSeconds),
+   receiveTimeout: const Duration(seconds: Constants.durationInSeconds),
+   sendTimeout: const Duration(seconds: Constants.durationInSeconds),
+ );
+ 
+ final aliceProvider = Provider&lt;Alice&gt;((ref) {
+   return Alice(
+     configuration: AliceConfiguration(
+       showNotification: !kReleaseMode,
+       showShareButton: !kReleaseMode,
+     ),
+   );
+ });
+ 
+ @Riverpod(keepAlive: true)
+ Dio dioConfig(Ref ref) {
+   final dio = Dio(_dioBaseOptions);
+ 
+   if (!kReleaseMode) {
+     final alice = ref.watch(aliceProvider);
+     final aliceDioAdapter = AliceDioAdapter();
+ 
+     alice.addAdapter(aliceDioAdapter);
+ 
+     dio.interceptors.add(aliceDioAdapter);
+     dio.interceptors.add(
+       LogInterceptor(
+         responseBody: true,
+         requestBody: true,
+         requestHeader: true,
+       ),
+     );
+   }
+ 
+   dio.interceptors.add(
+     QueuedInterceptorsWrapper(
+       onRequest: (options, handler) async {
+         // Add x-api-key header to every request
+         options.headers['x-api-key'] = F.apiKey;
+ 
+         String? accessToken = ref
+             .watch(authRepositoryProvider)
+             .currentUser
+             ?.accessToken;
+ 
+         if (accessToken == null) return handler.next(options);
+ 
+         // TODO: implement refresh token when API is ready
+         // if (_isTokenExpired(accessToken)) {
+         //   accessToken = await _getAccessTokenAfterRefresh(ref);
+         // }
+         options.headers['Authorization'] = 'Bearer $accessToken';
+ 
+         return handler.next(options);
+       },
+       onResponse: (response, handler) {
+         // Custom implementation error handling since API can return error code 200 but in the response it is not 200
+         final responseData = response.data;
+         if (responseData is Map &amp;&amp; responseData.containsKey('code')) {
+           final code = responseData['code'].toString();
+           if (code != '200' || code != '2000') {
+             return handler.reject(
+               DioException(
+                 requestOptions: response.requestOptions,
+                 response: response,
+                 type: DioExceptionType.badResponse,
+               ),
+             );
+           }
+         }
+         return handler.next(response);
+       },
+       onError: (error, handler) {
+         String msg = error.toString();
+         try {
+           if (error.response?.statusCode == 401) {
+             ref.read(authRepositoryProvider).clearSession();
+           }
+         } catch (e) {
+           msg = e.toString();
+         }
+ 
+         CommonUtils.printAndRecordLog(msg, '${error.stackTrace}');
+ 
+         return handler.next(error);
+       },
+     ),
+   );
+ 
+   return dio;
+ }
+ 
+ Future&lt;String?&gt; _getAccessTokenAfterRefresh(Ref ref) async {
+   try {
+     log('refresh token start');
+     final currentUser = ref.watch(authRepositoryProvider).currentUser;
+ 
+     final dioRefreshToken = Dio(_dioBaseOptions);
+     dioRefreshToken.interceptors.add(
+       LogInterceptor(
+         responseBody: true,
+         requestBody: true,
+         requestHeader: true,
+       ),
+     );
+ 
+     final response = await dioRefreshToken.get(
+       '/bastk/refresh-token',
+       options: Options(
+         headers: {'Authorization': 'Bearer ${currentUser?.refreshToken}'},
+       ),
+     );
+ 
+     final result = LoginResponse.fromJson(response.data);
+ 
+     ref
+         .read(authRepositoryProvider)
+         .saveSession(
+           currentUser!.copyWith(
+             accessToken: result.accessToken,
+             refreshToken: result.refreshToken,
+           ),
+         );
+ 
+     log('refresh token success');
+     return result.accessToken!;
+   } catch (e, stackTrace) {
+     CommonUtils.printAndRecordLog(e, stackTrace.toString());
+     await ref.read(authRepositoryProvider).clearSession();
+ 
+     return null;
+   }
+ }
+ 
+ bool _isTokenExpired(String token) {
+   try {
+     final tokenToJson = CommonUtils.decodeTokenAsJson(token);
+     final expTime = tokenToJson['exp'] as int;
+ 
+     final expiredTime = DateTime.fromMillisecondsSinceEpoch(expTime * 1000);
+ 
+     return DateTime.now().isAfter(expiredTime);
+   } catch (e) {
+     return true;
+   }
+ }
+ 
+ onDioError(DioException error) {
+   if (error.type == DioExceptionType.badResponse) {
+     String errorMessage = error.response!.data['message']
+         .toString()
+         .replaceAll('[', '')
+         .replaceAll(']', '');
+     throw errorMessage;
+   } else if (error.type == DioExceptionType.cancel) {
+     throw ErrorMessage.requestCancelled;
+   } else if (error.type == DioExceptionType.badCertificate) {
+     throw ErrorMessage.certificateNotApproved;
+   } else if (error.type == DioExceptionType.connectionError) {
+     throw ErrorMessage.noAddressAssociatedWithHostname;
+   } else if (error.type == DioExceptionType.connectionTimeout) {
+     throw ErrorMessage.requestTimeoutMsg;
+   } else {
+     throw ErrorMessage.defaultUnParseErrorMsg;
+   }
+ }
+ 
```

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="write">

<details><summary>Tool use: **write** • Edit file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/utils/data_source_config/{{#use_dio}}dio{{/use_dio}}/dio_config.g.dart</summary>

**Chunk 1**
Lines added: 51, lines removed: 1

```diff
@@ -1,1 +1,51 @@
- 
+ // GENERATED CODE - DO NOT MODIFY BY HAND
+ 
+ part of 'dio_config.dart';
+ 
+ // **************************************************************************
+ // RiverpodGenerator
+ // **************************************************************************
+ 
+ // GENERATED CODE - DO NOT MODIFY BY HAND
+ // ignore_for_file: type=lint, type=warning
+ 
+ @ProviderFor(dioConfig)
+ const dioConfigProvider = DioConfigProvider._();
+ 
+ final class DioConfigProvider extends $FunctionalProvider&lt;Dio, Dio, Dio&gt;
+     with $Provider&lt;Dio&gt; {
+   const DioConfigProvider._()
+     : super(
+         from: null,
+         argument: null,
+         retry: null,
+         name: r'dioConfigProvider',
+         isAutoDispose: false,
+         dependencies: null,
+         $allTransitiveDependencies: null,
+       );
+ 
+   @override
+   String debugGetCreateSourceHash() =&gt; _$dioConfigHash();
+ 
+   @$internal
+   @override
+   $ProviderElement&lt;Dio&gt; $createElement($ProviderPointer pointer) =&gt;
+       $ProviderElement(pointer);
+ 
+   @override
+   Dio create(Ref ref) {
+     return dioConfig(ref);
+   }
+ 
+   /// {@macro riverpod.override_with_value}
+   Override overrideWithValue(Dio value) {
+     return $ProviderOverride(
+       origin: this,
+       providerOverride: $SyncValueProvider&lt;Dio&gt;(value),
+     );
+   }
+ }
+ 
+ String _$dioConfigHash() =&gt; r'7ee90bc74c09de0e6b2503d8218ec7d975d6c111';
+ 
```

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="write">

<details><summary>Tool use: **write** • Edit file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/utils/data_source_config/{{#use_dio}}dio{{/use_dio}}/cancel_token_ref.dart</summary>

**Chunk 1**
Lines added: 11, lines removed: 1

```diff
@@ -1,1 +1,11 @@
- 
+ import 'package:dio/dio.dart';
+ import 'package:flutter_riverpod/flutter_riverpod.dart';
+ 
+ extension CancelTokenRef on Ref {
+   CancelToken cancelToken() {
+     final cancelToken = CancelToken();
+     onDispose(cancelToken.cancel);
+     return cancelToken;
+   }
+ }
+ 
```

</details>

</tool-use>

---



---

Updating `login_repository.dart` to conditionally use Dio. When `use_dio` is false, using the `http` package as an alternative:


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/feature/login/data/login_repository.dart</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/feature/login/domain/login_response.dart</summary>

</details>
</tool-use>

---



---

Updating `login_repository.dart` to conditionally use Dio:


---

<tool-use data-tool-type="write" data-tool-name="search_replace">

<details><summary>Tool use: **search_replace** • Edit file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/feature/login/data/login_repository.dart</summary>

**Chunk 1**
Lines added: 5, lines removed: 1

```diff
@@ -1,7 +1,11 @@
+ {{#use_dio}}
  import 'package:dio/dio.dart';
+ {{/use_dio}}
  import 'package:riverpod_annotation/riverpod_annotation.dart';
  
  import '../../../../flavor.dart';
- import '../../../utils/data_source_config/dio/dio_config.dart';
+ {{#use_dio}}
+ import '../../../utils/data_source_config/{{#use_dio}}dio{{/use_dio}}/dio_config.dart';
+ {{/use_dio}}
  import '../../authentication/data/auth_repository.dart';
  import '../domain/login_response.dart';
```

**Chunk 2**
Lines added: 1, lines removed: undefined

```diff
@@ -16,4 +20,5 @@
    required String recaptchaToken,
  }) async {
+   {{#use_dio}}
    try {
      final dio = ref.watch(dioConfigProvider);
```

**Chunk 3**
Lines added: 5, lines removed: undefined

```diff
@@ -51,4 +56,9 @@
      rethrow;
    }
+   {{/use_dio}}
+   {{^use_dio}}
+   // TODO: Implement HTTP client of your choice (e.g., http package, chopper, etc.)
+   throw UnimplementedError('Login not implemented. Please implement your HTTP client.');
+   {{/use_dio}}
  }
  
```

</details>

</tool-use>

---



---

Updating `app_router.dart` to conditionally use Dio/Alice:


---

<tool-use data-tool-type="write" data-tool-name="search_replace">

<details><summary>Tool use: **search_replace** • Edit file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/routing/app_router.dart</summary>

**Chunk 1**
Lines added: 3, lines removed: 1

```diff
@@ -10,5 +10,7 @@
  import '../feature/login/presentation/login_screen.dart';
  import '../feature/main_nav/presentation/main_nav_screen.dart';
- import '../utils/data_source_config/dio/dio_config.dart';
+ {{#use_dio}}
+ import '../utils/data_source_config/{{#use_dio}}dio{{/use_dio}}/dio_config.dart';
+ {{/use_dio}}
  import 'go_router_refresh_stream.dart';
  
```

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="search_replace">

<details><summary>Tool use: **search_replace** • Edit file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/routing/app_router.dart</summary>

**Chunk 1**
Lines added: 7, lines removed: 1

```diff
@@ -22,8 +22,14 @@
  GoRouter goRouter(Ref ref) {
    final authRepository = ref.watch(authRepositoryProvider);
+   {{#use_dio}}
+   final navigatorKey = ref.watch(aliceProvider).getNavigatorKey();
+   {{/use_dio}}
+   {{^use_dio}}
+   final navigatorKey = GlobalKey&lt;NavigatorState&gt;();
+   {{/use_dio}}
    return GoRouter(
      initialLocation: '${MainNavScreen.path}/0',
      debugLogDiagnostics: !kReleaseMode &amp;&amp; F.appFlavor != Flavor.prod,
-     navigatorKey: ref.watch(aliceProvider).getNavigatorKey(),
+     navigatorKey: navigatorKey,
      refreshListenable: GoRouterRefreshStream(
        authRepository.authStateChangesStream(),
```

</details>

</tool-use>

---



---

Deleting the old dio directory files since we've created the conditional structure:


---

<tool-use data-tool-type="write" data-tool-name="delete_file">
<details><summary>Tool use: **delete_file**</summary>

Explanation: undefined


</details>
</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="delete_file">
<details><summary>Tool use: **delete_file**</summary>

Explanation: undefined


</details>
</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="delete_file">
<details><summary>Tool use: **delete_file**</summary>

Explanation: undefined


</details>
</tool-use>

---



---

Fixing redundant conditional syntax in import paths:


---

<tool-use data-tool-type="write" data-tool-name="search_replace">

<details><summary>Tool use: **search_replace** • Edit file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/feature/login/data/login_repository.dart</summary>

**Chunk 1**
Lines added: 1, lines removed: 1

```diff
@@ -6,5 +6,5 @@
  import '../../../../flavor.dart';
  {{#use_dio}}
- import '../../../utils/data_source_config/{{#use_dio}}dio{{/use_dio}}/dio_config.dart';
+ import '../../../utils/data_source_config/dio/dio_config.dart';
  {{/use_dio}}
  import '../../authentication/data/auth_repository.dart';
```

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="search_replace">

<details><summary>Tool use: **search_replace** • Edit file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/routing/app_router.dart</summary>

**Chunk 1**
Lines added: 1, lines removed: 1

```diff
@@ -11,5 +11,5 @@
  import '../feature/main_nav/presentation/main_nav_screen.dart';
  {{#use_dio}}
- import '../utils/data_source_config/{{#use_dio}}dio{{/use_dio}}/dio_config.dart';
+ import '../utils/data_source_config/dio/dio_config.dart';
  {{/use_dio}}
  import 'go_router_refresh_stream.dart';
```

</details>

</tool-use>

---



---

Checking how Firebase imports are handled to confirm the pattern:


---

<tool-use data-tool-type="search" data-tool-name="grep">
<details>
<summary>Tool use: **grep** • Grep for "import.*firebase" in "src/__brick__" • 10 matches</summary>

Output mode: content


| File | Content | Line |
|------|------|------|
| `src/__brick__/\{{project_name\}}/lib/src/routing/app_startup.dart` | `import '../service/firebase/firebase_service.dart';` | L16 |
| `src/__brick__/\{{project_name\}}/lib/src/service/\{{#use_firebase\}}firebase\{{/use_firebase\}}/firebase_service.dart` | `import 'package:firebase_messaging/firebase_messaging.dart';` | L4 |
| `src/__brick__/\{{project_name\}}/lib/src/service/notification/local_notification.dart` | `import 'package:firebase_messaging/firebase_messaging.dart';` | L4 |
| `src/__brick__/\{{project_name\}}/lib/src/service/notification/local_notification.dart` | `import '../firebase/firebase_service.dart';` | L10 |
| `src/__brick__/\{{project_name\}}/lib/initializer.dart` | `import 'package:firebase_core/firebase_core.dart';` | L2 |
| `src/__brick__/\{{project_name\}}/lib/initializer.dart` | `import 'package:firebase_messaging/firebase_messaging.dart';` | L3 |
| `src/__brick__/\{{project_name\}}/lib/initializer.dart` | `import 'src/service/firebase/firebase_service.dart';` | L13 |
| `src/__brick__/\{{project_name\}}/lib/main_prod.dart` | `import 'firebase_options/firebase_options_prod.dart';` | L2 |
| `src/__brick__/\{{project_name\}}/lib/main_dev.dart` | `import 'firebase_options/firebase_options_dev.dart';` | L2 |
| `src/__brick__/\{{project_name\}}/lib/main_stg.dart` | `import 'firebase_options/firebase_options_stg.dart';` | L2 |


</details>
</tool-use>

---



---

Checking how conditional imports are handled in other files:


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/routing/app_startup.dart</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/service/notification/local_notification.dart</summary>

</details>
</tool-use>

---



---

The pattern is correct. Verifying the final state of the modified files:


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/feature/login/data/login_repository.dart</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/lib/src/routing/app_router.dart</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/__brick__/{{project_name}}/pubspec.yaml</summary>

</details>
</tool-use>

---



---

Verifying the conditional directory structure exists:


---

<tool-use data-tool-type="generic" data-tool-name="list_dir">
<details>
            <summary>Tool use: **list_dir** • Listed directory, 0 results</summary>
        
No results found
</details>
</tool-use>

---



---

Checking if the old dio directory is empty:


---

<tool-use data-tool-type="generic" data-tool-name="list_dir">
<details>
            <summary>Tool use: **list_dir** • Listed directory, 0 results</summary>
        
No results found
</details>
</tool-use>

---



---

The old `dio/` directory is empty and harmless. The conditional structure `{{#use_dio}}dio{{/use_dio}}/` will work correctly. Summary of changes:

## Summary

Implemented conditional `use_dio` support in the Mason brick template:

1. **pubspec.yaml** - Wrapped Dio dependencies (`dio`, `alice_dio`, `alice`) with `{{#use_dio}}...{{/use_dio}}`

2. **Directory structure** - Created conditional directory:
   - `lib/src/utils/data_source_config/{{#use_dio}}dio{{/use_dio}}/` containing:
     - `dio_config.dart`
     - `dio_config.g.dart`
     - `cancel_token_ref.dart`
   - Deleted old files from the non-conditional `dio/` directory

3. **login_repository.dart** - Made Dio usage conditional:
   - Conditionally imports Dio and dio_config
   - When `use_dio` is true: uses Dio as before
   - When `use_dio` is false: throws `UnimplementedError` with a TODO

4. **app_router.dart** - Made Alice/Dio usage conditional:
   - Conditionally imports dio_config
   - When `use_dio` is true: uses `aliceProvider.getNavigatorKey()`
   - When `use_dio` is false: uses `GlobalKey<NavigatorState>()`

The implementation follows the same pattern as `use_firebase` and `use_localization`. When `use_dio` is false, the Dio directory and dependencies are excluded, and alternative implementations are provided where needed.

---

