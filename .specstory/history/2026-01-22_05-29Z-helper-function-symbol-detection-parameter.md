<!-- Generated by SpecStory, Markdown v2.1.0 -->

<!-- cursor Session dab7a00d-9790-4589-8b3d-2326f5bb7762 (2026-01-22 05:29Z) -->

# Helper function symbol detection parameter (2026-01-22 05:29Z)

_**User**_

@src/hooks/helper.dart add param to detect if the value has symbol on it

---

_**Agent (model MiniMax-M2.1, mode Agent)**_

<think>
The user wants me to add a parameter to detect if a value contains symbols in the helper.dart file. I need to first read the file to understand the current implementation and then add the requested functionality.

Let me read the file first to understand its current structure.
</think>

I'll read the helper.dart file to understand its current implementation and then add a parameter to detect if a value contains symbols.


---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/hooks/helper.dart</summary>

</details>
</tool-use>

---

<think>
The user wants me to add a parameter to detect if a value contains symbols. Looking at the code, I can see there's a `validateRetriable` function that handles value validation. The user likely wants to add a parameter that can check if a value contains special symbols.

I'll add a `validateRetriable` method with an additional parameter `bool Function(String)? validateSymbol` that allows checking if the value contains symbols. This will give flexibility to the caller to define what constitutes a symbol.

Let me add this functionality to the `validateRetriable` method.
</think>

I'll add a `validateSymbol` parameter to the `validateRetriable` method that allows checking if a value contains symbols. This provides flexibility for custom symbol validation logic.


---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/cirimin/Logique/Project Starter/project-starter/src/hooks/helper.dart</summary>

</details>

</tool-use>

---

<think>
The user wants me to add a parameter to detect if the value has symbols on it. Looking at the context, they're working with a Dart file (helper.dart) and want to enhance the `validateRetriable` method to detect symbols.

I need to provide a clear explanation of what I did and show the code changes. Let me format this properly.
</think>

I've added a `validateSymbol` parameter to the `validateRetriable` method in `helper.dart:115`. This parameter accepts an optional callback function that receives the input value and returns `true` if symbols are detected.

**Changes made:**
- Added `bool Function(String value)? validateSymbol` parameter to `validateRetriable`
- Added validation logic that checks the value using the provided callback
- Shows an error message when symbols are detected and allows retry
- Throws a `MasonException` if symbols persist after max attempts

**Usage example:**
```dart
HookHelper.validateRetriable(
  context,
  key: 'app_id',
  promptMessage: 'Enter your app ID (e.g., com.example.myapp)',
  errorMessage: 'App ID cannot be empty',
  infoMessage: 'Use lowercase letters, numbers, and dots only',
  validateSymbol: (value) => !RegExp(r'^[a-z0-9.]+$').hasMatch(value),
);
```

The `validateSymbol` callback should return `true` when symbols are detected (invalid) and `false` when the value is valid.

---

_**User**_

make it to detect all symbol except "."

---

_**Agent (model MiniMax-M2.1, mode Agent)**_

<think>
The user wants to modify the validation to detect all symbols except the dot (`.`) character. This means the validation should allow only:
- Letters (a-z, A-Z)
- Numbers (0-9)
- Dots (.)

And reject everything else (like @, #, $, %, etc.).

I need to update the regex pattern in the helper.dart file to allow dots but reject all other special characters/symbols.
</think>

I'll update the `validateSymbol` parameter to detect all symbols except dots. I'll add a default regex pattern that allows only alphanumeric characters and dots.


---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/hooks/helper.dart</summary>

</details>
</tool-use>

---

<think>
The user wants to modify the validation to detect all symbols except the dot (`.`) character. I need to create a default validation function that rejects any character that is not:
- A letter (a-z, A-Z)
- A number (0-9)
- A dot (.)

I should add a default implementation that can be used when `validateSymbol` is not provided, or I can create a helper function that provides this default behavior.

Let me create a helper function that checks for invalid symbols (everything except alphanumeric and dots), and use it as the default when validateSymbol is not provided.
</think>

I'll add a default validation that rejects all symbols except dots. I'll create a helper method and update the `validateRetriable` method to use it.


---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/cirimin/Logique/Project Starter/project-starter/src/hooks/helper.dart</summary>

</details>

</tool-use>

---

<think>
Now I need to add the helper function `_hasInvalidSymbols` that returns true if the value contains any symbol except dots. I'll add it near the other private helper functions at the bottom of the file.
</think>




---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/hooks/helper.dart</summary>

</details>
</tool-use>

---

<think>
Now I need to add the `_hasInvalidSymbols` function at the end of the file. This function should return `true` if the value contains any character that is not:
- A letter (a-z, A-Z)
- A number (0-9)
- A dot (.)

I'll use a regex pattern that matches any character that is NOT alphanumeric or a dot.
</think>




---

<tool-use data-tool-type="write" data-tool-name="edit_file_v2">

<details><summary>Tool use: **edit_file_v2** • Edit file: /Users/cirimin/Logique/Project Starter/project-starter/src/hooks/helper.dart</summary>

</details>

</tool-use>

---

<think>
I've added the `_hasInvalidSymbols` function and updated the `validateRetriable` method to use it as a default when `validateSymbol` is not provided. The function uses a regex pattern `[^a-zA-Z0-9.]` which matches any character that is NOT:
- a-z (lowercase letters)
- A-Z (uppercase letters)
- 0-9 (numbers)
- . (dot)

This means it will return true (invalid) if any other symbol is present.

Let me verify the changes by reading the file to make sure everything is correct.
</think>

I've updated the `validateRetriable` method to include default symbol detection that rejects all symbols except dots.

**Changes made:**

1. Added `_hasInvalidSymbols(String value)` function at line 245 that uses regex `[^a-zA-Z0-9.]` to detect any character that is NOT:
   - Letters (a-z, A-Z)
   - Numbers (0-9)
   - Dot (.)

2. Updated `validateRetriable` to use this as the default validation when `validateSymbol` is not provided

**Usage:**

```dart
// Default behavior - rejects all symbols except dots
HookHelper.validateRetriable(
  context,
  key: 'app_id',
  promptMessage: 'Enter your app ID',
  errorMessage: 'App ID cannot be empty',
  infoMessage: 'Use only letters, numbers, and dots',
);

// Custom validation - still supported
HookHelper.validateRetriable(
  context,
  key: 'some_key',
  promptMessage: 'Enter value',
  errorMessage: 'Value cannot be empty',
  infoMessage: 'Some info',
  validateSymbol: (value) => value.contains('@'), // custom logic
);
```

---

_**User**_

if we already use @src/brick.yaml variable, can we overwrite the variable?

---

_**Agent (model MiniMax-M2.1, mode Ask)**_

<think>
The user is asking about whether they can overwrite variables that are already defined in the `brick.yaml` file. They want to know if values set in `brick.yaml` can be overridden.

Let me read the `brick.yaml` file to understand what variables are defined there.
</think>




---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: /Users/cirimin/Logique/Project Starter/project-starter/src/brick.yaml</summary>

</details>
</tool-use>

---

<think>
The user is asking whether variables defined in `brick.yaml` can be overwritten. Let me explain this based on how Mason bricks work.

From the `brick.yaml` file, I can see that variables are defined with their types, descriptions, defaults, and prompts. 

In Mason, variables defined in `brick.yaml` can indeed be overwritten. There are several ways to do this:

1. **Command-line override**: When running `mason make`, you can pass variables directly via the `--var` flag
2. **mason.yaml configuration**: Variables can be set in the `mason.yaml` file that locks the brick configuration
3. **Programmatically in hooks**: In pre_gen or post_gen hooks, you can modify `context.vars[key]` to change the value

The user's recent edit to `helper.dart` shows they're working with a `validateSymbols` boolean parameter. This suggests they want to enable/disable symbol validation based on a configuration variable.

Let me provide a clear answer about how to overwrite brick.yaml variables.
</think>

Yes, you can overwrite variables defined in `brick.yaml`. Here are the ways to do it:

## 1. Command-Line Override

When running `mason make`, pass variables directly:

```bash
mason make starter --var validate_symbols=true
```

## 2. Programmatic Override in Hooks

In `pre_gen.dart` or `post_gen.dart`, you can modify `context.vars`:

```dart
void main(HookContext context) async {
  // Overwrite brick.yaml variable
  context.vars['validateSymbols'] = true;
  
  // Or check and modify based on conditions
  if (someCondition) {
    context.vars['app_id'] = 'com.overridden.app';
  }
}
```

## 3. Using a `mason.yaml` Lock File

Create a `mason.yaml` in your project to lock variable values:

```yaml
bricks:
  starter:
    path: ../path/to/starter
    version: 0.1.6
vars:
  validate_symbols: true
  app_id: com.custom.app
```

## For Your Current Implementation

Based on your recent edit to `helper.dart`, you can add `validateSymbols` to `brick.yaml`:

```yaml
vars:
  # ... existing vars ...
  validate_symbols:
    type: boolean
    description: Whether to validate input for invalid symbols
    default: false
    prompt: Enable symbol validation?
```

Then in your hooks, the `validateSymbols` variable from `brick.yaml` will be available in `context.vars['validateSymbols']` and will automatically be checked in your `validateRetriable` method.

---

